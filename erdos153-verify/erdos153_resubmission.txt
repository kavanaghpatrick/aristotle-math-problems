# Erdős Problem #153 - Correct Formalization

## Problem Statement (from erdosproblems.com/153)

Let A be a finite Sidon set and A+A = {s₁ < s₂ < ... < sₜ}.

PROVE OR DISPROVE: For ALL sequences of finite Sidon sets {Aₙ} with |Aₙ| → ∞,

    (1/t) · Σᵢ (sᵢ₊₁ - sᵢ)² → ∞

where t = |Aₙ + Aₙ|.

## Critical Clarification

This is a UNIVERSAL statement about ALL Sidon sets, not an existential statement.

- WRONG: "∀M, ∃A: avg_sq_gap(A) > M" (trivially true via powers of two)
- CORRECT: "∀ sequences {Aₙ} of Sidon sets with |Aₙ| → ∞: avg_sq_gap(Aₙ) → ∞"

## Key Definitions

```lean
-- A Sidon set has all pairwise sums distinct
def IsSidonSet (A : Finset ℕ) : Prop :=
  ∀ a b c d, a ∈ A → b ∈ A → c ∈ A → d ∈ A → a + b = c + d → ({a, b} : Finset ℕ) = {c, d}

-- Average squared gap of the sumset
def averageSquaredGap (A : Finset ℕ) : ℚ :=
  let S := (A +ᶠ A).sort (·≤·)  -- sorted sumset
  let t := S.length
  if t < 2 then 0
  else (1/t) * Σᵢ (S[i+1] - S[i])²

-- THE CORRECT PROBLEM STATEMENT
def ErdosProblem153 : Prop :=
  ∀ (f : ℕ → ℕ), (∀ n, f n < f (n+1)) →  -- f(n) → ∞
  ∀ (A : ℕ → Finset ℕ), (∀ n, IsSidonSet (A n)) →
  (∀ n, (A n).card ≥ f n) →
  Filter.Tendsto (fun n => averageSquaredGap (A n)) Filter.atTop Filter.atTop
```

## Why This Is Hard

The challenge is proving this for DENSE Sidon sets (like Singer constructions) where:
- |A ∩ [1,N]| ≈ √N (near-optimal density)
- Average gap in A+A ≈ constant
- But average SQUARED gap still grows (empirically verified)

## Empirical Evidence

Computational experiments show avg_sq_gap grows even for dense greedy Sidon sets:
- N=50:  avg_sq_gap ≈ 13
- N=100: avg_sq_gap ≈ 19
- N=200: avg_sq_gap ≈ 35
- N=400: avg_sq_gap ≈ 72
- N=800: avg_sq_gap ≈ 129

## Key Mathematical Tools

1. Erdős-Sárközy-Sós (1994): A+A cannot contain > C√N consecutive integers
   This forces "breaks" in the sumset that create large gaps.

2. For Sidon set A: |A+A| = |A|(|A|+1)/2 (unique sums)

3. Variance argument: Even if avg gap is constant, variance of gaps may grow,
   causing avg squared gap to grow.

## You Decide

- The proof strategy
- Which lemmas to prove
- How to handle dense vs sparse cases

## Success Criterion

Prove ErdosProblem153 (the universal statement) with zero sorries.
