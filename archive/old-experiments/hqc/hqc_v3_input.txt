## Problem Title: HQC v3 - Exploiting Quasi-Cyclic Structure for Security Analysis

---

## Executive Summary

This problem addresses the critical gap in HQC v2: **lack of quasi-cyclic (QC) structure exploitation**. While v2 proved security bounds using generic linear code parameters (n, k, t), v3 explicitly exploits circulant matrix properties, eigenvalue decomposition, polynomial ring representations, and automorphism group structure. The goal is to prove tighter security bounds that are specific to HQC's quasi-cyclic design, providing the first formal analysis that accounts for how circulant structure affects attack complexity.

**Key Difference from v2:** v2 could apply to ANY [n,k,t] linear code. v3 MUST use properties unique to quasi-cyclic codes.

---

## Background: HQC Quasi-Cyclic Structure

### HQC-128 Parameters
- **n = 17669** (code length)
- **k = 13893** (dimension)
- **m = n - k = 3776** (parity check rows)
- **t = 66** (error weight)
- **r = 83** (block size for quasi-cyclic structure)
- **Block decomposition**: n = 213 × 83

### Quasi-Cyclic Structure

**Parity Check Matrix H:**
- H is **doubly-circulant**: H = [H₁ | H₂]
- Each Hᵢ is composed of 213×213 matrix of 83×83 circulant blocks
- Each circulant block is generated by a single row via cyclic shifts

**Key Properties:**
1. **Circulant matrices** are diagonalized by FFT (Fast Fourier Transform)
2. **Eigenvalues** can be computed via polynomial evaluation at roots of unity
3. **Automorphism group**: Cyclic group C₈₃ acts on code via shifts
4. **Polynomial representation**: Code embeds in ℤ₂[x]/(x⁸³ - 1)
5. **Dual code**: If H is quasi-cyclic, then dual code is also quasi-cyclic

---

## Goal 1: Automorphism Group Analysis for ISD Complexity

### Question
Does the cyclic automorphism group C₈₃ reduce the ISD search space, or does symmetry prevent shortcuts?

### Task
**Prove:** For HQC's quasi-cyclic parity check matrix H with block size r=83, prove that ISD must search over at least N_orbits distinct orbits under the action of C₈₃, where:

- Each orbit contains at most 83 information sets (due to cyclic symmetry)
- The total number of orbits N_orbits ≥ C(n,k) / 83

**Then prove:** Even accounting for orbit structure, the ISD complexity is at least:
```
ISD_Complexity_QC ≥ (C(n,t) / C(m,t)) / 83
```

**Show this is still ≥ 2^100** for HQC-128 parameters.

### Formalization Requirements
1. Define automorphism group action: `AutGroup := C₈₃` acting on information sets
2. Define orbit decomposition of information sets
3. Prove orbit sizes bounded by 83
4. Prove lower bound accounting for symmetry reduction

---

## Goal 2: Circulant Eigenvalue Analysis via FFT

### Question
How do circulant matrix eigenvalues (computed via FFT) affect syndrome decoding complexity?

### Task
**Prove:** For each circulant block Hᵢⱼ ∈ ℤ₂^(83×83), the eigenvalues are:
```
λₖ = polynomial_eval(h, ω^k) where ω = e^(2πi/83)
```
where h is the generating row of the circulant.

**Then prove:** Syndrome decoding complexity depends on the number of non-zero eigenvalues. Specifically:
- If Hᵢⱼ has d_nz non-zero eigenvalues, then decoding requires at least 2^(d_nz/2) operations
- For HQC-128 circulant blocks, prove d_nz ≥ 40 (on average)
- This implies a lower bound of 2^20 per block

**Aggregate over all 213×2 = 426 blocks** to get overall bound ≥ 2^80.

### Formalization Requirements
1. Define circulant matrix via generating row
2. Define FFT-based eigenvalue computation in ℤ₂[x]/(x^83 - 1)
3. Prove relationship between eigenvalues and decoding complexity
4. Count non-zero eigenvalues for HQC parameters

---

## Goal 3: Polynomial Ring Representation and Gröbner Basis Complexity

### Question
Does representing HQC in polynomial ring ℤ₂[x]/(x^n - 1) reveal algebraic attack complexity?

### Task
**Prove:** HQC code can be represented as ideal I ⊂ ℤ₂[x]/(x^17669 - 1) generated by polynomials g₁(x), g₂(x) corresponding to circulant rows.

**Then prove:** Solving QCSD in polynomial representation requires computing a Gröbner basis for the ideal:
```
⟨g₁(x), g₂(x), s(x) - e(x)·H(x)⟩
```
where deg(e) = 66.

**Show:** Gröbner basis computation for this ideal requires at least 2^60 operations (via degree bound analysis).

### Formalization Requirements
1. Define polynomial ring ℤ₂[x]/(x^n - 1)
2. Represent circulant matrices as polynomial multiplication
3. Define Gröbner basis degree for QCSD ideal
4. Prove complexity lower bound via degree analysis

---

## Goal 4: Independence Assumption Verification for Quasi-Cyclic Codes

### Question
Classical ISD analysis assumes information set trials are independent. Does this hold for quasi-cyclic codes?

### Task
**Prove or disprove:** For quasi-cyclic codes, the correlation coefficient ρ between successive information set trials satisfies:
```
ρ ≤ 1/r + ε
```
where r=83 is block size and ε is negligible.

**If ρ is small:** Prove that independence assumption holds, and ISD complexity is at least the generic bound.

**If ρ is large:** Prove that correlation INCREASES complexity (attacker cannot exploit structure), giving tighter bound.

**Reference:** Recent work suggests QC structure may violate independence (arXiv:2501.02626, Jan 2025).

### Formalization Requirements
1. Define correlation coefficient for information set trials
2. Analyze how cyclic shifts affect trial independence
3. Prove bound on ρ for r=83 block size
4. Show impact on overall ISD complexity

---

## Goal 5: Dual Code Analysis for Tighter Bounds

### Question
Can quasi-cyclic dual code structure provide tighter security bounds?

### Task
**Prove:** For HQC's quasi-cyclic dual code C^⊥:
1. The dual code is also quasi-cyclic with same block structure (r=83)
2. The dual distance d^⊥ ≥ d_min (specific lower bound for QC codes)
3. ISD complexity can be bounded via covering radius: ρ(C^⊥) ≤ f(n, k, d^⊥)

**Then prove:** Using dual code analysis:
```
ISD_Complexity ≥ C(n, ρ(C^⊥)) ≥ 2^95
```

**Show this is TIGHTER** than primal-only bound (2^100 from v2).

### Formalization Requirements
1. Define dual code C^⊥ for quasi-cyclic code C
2. Prove dual is quasi-cyclic with same block structure
3. Compute covering radius bounds for QC dual codes
4. Derive ISD complexity from dual parameters

---

## Formalization Requirements Summary

The Lean 4 proof MUST include:

### Core Definitions
```lean
-- Circulant matrix via generating row
def CirculantMatrix (r : ℕ) (gen : Fin r → ZMod 2) : Matrix (Fin r) (Fin r) (ZMod 2)

-- Eigenvalues via FFT (roots of unity evaluation)
def circulant_eigenvalues (r : ℕ) (gen : Fin r → ZMod 2) : Fin r → ℂ

-- Automorphism group action
def cyclic_shift_action (r : ℕ) : Equiv.Perm (Fin r)

-- Polynomial ring representation
def poly_ring_code (n : ℕ) : Type := Ideal (Polynomial (ZMod 2))

-- Quasi-cyclic dual code
def qc_dual_code (m n r : ℕ) (C : QCCode m n r) : QCCode n m r
```

### Core Theorems
```lean
-- Goal 1: Automorphism bound
theorem isd_qc_automorphism_bound :
  ISD_Complexity_QC ≥ (C(n,t) / C(m,t)) / r

-- Goal 2: Eigenvalue bound
theorem eigenvalue_decoding_bound :
  ∀ block : CirculantBlock, num_nonzero_eigenvalues block ≥ 40 →
  decoding_complexity block ≥ 2^20

-- Goal 3: Gröbner basis bound
theorem groebner_qcsd_bound :
  groebner_degree (qcsd_ideal) ≥ 60 →
  algebraic_attack_complexity ≥ 2^60

-- Goal 4: Independence verification
theorem qc_independence_bound :
  correlation_coefficient ≤ 1/r + ε →
  isd_trials_required ≥ generic_isd_bound

-- Goal 5: Dual code bound
theorem qc_dual_covering_radius :
  covering_radius (qc_dual C) ≤ f(n,k,d_dual) →
  ISD_Complexity ≥ 2^95
```

---

## Success Criteria

To verify QC structure was genuinely exploited, the proof MUST:

✅ **Use circulant eigenvalues explicitly** (FFT-based computation)
✅ **Analyze automorphism group C₈₃** (orbit structure, symmetry reduction)
✅ **Use polynomial ring representation** (ℤ₂[x]/(x^n-1))
✅ **Reference cyclotomic polynomials** or roots of unity
✅ **Analyze dual code with QC structure** (not generic dual)
✅ **Compare QC vs generic codes** ("QC requires 2^X, generic requires 2^Y")

### Red Flags (means we failed AGAIN):
❌ Only uses C(n,t)/C(m,t) formulas (generic bound)
❌ CirculantMatrix defined but never used in proofs
❌ No FFT, eigenvalues, or roots of unity mentioned
❌ No automorphism group analysis
❌ Proof could apply to any [n,k,t] linear code
❌ No polynomial ring operations

---

## Expected Output Structure

### Part 1: Definitions (50-80 lines)
- Circulant matrices with FFT eigenvalues
- Automorphism group C₈₃ and orbit structure
- Polynomial ring ℤ₂[x]/(x^n-1)
- QC dual code structure

### Part 2: Automorphism Analysis (40-60 lines)
- Orbit decomposition of information sets
- Proof of orbit size bounds
- ISD complexity accounting for symmetry

### Part 3: Eigenvalue Analysis (50-70 lines)
- FFT-based eigenvalue computation
- Counting non-zero eigenvalues
- Lower bound via eigenvalue distribution

### Part 4: Polynomial Representation (40-60 lines)
- Code as ideal in polynomial ring
- Gröbner basis degree bounds
- Algebraic attack complexity

### Part 5: Independence Analysis (30-50 lines)
- Correlation coefficient for QC codes
- Impact on ISD trial independence
- Complexity adjustment

### Part 6: Dual Code Analysis (40-60 lines)
- QC dual code construction
- Covering radius bounds
- Tighter ISD complexity via dual

### Part 7: Overall Security (20-30 lines)
- Combine all bounds via union bound
- Prove overall security ≥ 2^80
- Compare to v2 (show improvement or equivalence)

**Total Target:** 250-400 lines (vs v2's 111-167 lines)

---

## Novelty Assessment

### Why v3 Could Achieve 7-8/10 (vs v2's 5-6/10):

1. **First formal proof** exploiting QC structure in HQC security
2. **Eigenvalue analysis** unique to circulant codes
3. **Automorphism group** approach novel in formal verification
4. **Polynomial ring** representation not used in v2
5. **Dual code QC structure** provides potential tighter bounds
6. **Independence analysis** addresses recent open question (2025 paper)

### What Makes This Novel:
- Existing work: Generic ISD bounds for HQC (textbook)
- Our contribution: **Formal proof accounting for QC structure**
- First to formalize: Eigenvalues, automorphisms, polynomial representation
- Potential: Tighter bounds via structural exploitation

---

## Notes for Aristotle

**Concrete Parameters:** Use HQC-128 (n=17669, k=13893, t=66, r=83) throughout.

**Verification:** For Goals 2-3, may need to use `native_decide` for counting eigenvalues or computing Gröbner degrees on specific circulant blocks.

**Comparison:** Explicitly compare QC-specific bounds to generic linear code bounds from v2.

**Success:** Even if not all goals are achieved, proving ANY goal using QC structure represents progress over v2.

**Target:** Novelty 7-8/10 requires at least 3 goals with genuine QC exploitation.
