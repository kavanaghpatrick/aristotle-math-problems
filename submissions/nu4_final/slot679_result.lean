/-
This file was generated by Aristotle (https://aristotle.harmonic.fun).

Lean version: leanprover/lean4:v4.24.0
Mathlib version: f897ebcf72cd16f89ab4577d0c826cd14afaafc7
This project request had uuid: 577c75e6-de9e-4d29-9994-e9aa1d3a7a0b

To cite Aristotle, tag @Aristotle-Harmonic on GitHub PRs/issues, and add as co-author to commits:
Co-authored-by: Aristotle (Harmonic) <aristotle-harmonic@harmonic.fun>
-/

/-
We formalized the Second Hardy-Littlewood conjecture as `SecondHardyLittlewoodConjectureFor`. We proved the conjecture for specific values $y=2, 3, 4$ in `second_hardy_littlewood_conjecture_y_eq_2`, `second_hardy_littlewood_conjecture_y_eq_3`, and `second_hardy_littlewood_conjecture_y_eq_4`. We also proved a weaker upper bound `primeCounting_add_le_add` stating $\pi(x+y) \le \pi(x) + y$. The full conjecture remains open and is believed to be false.
-/

import Mathlib

set_option linter.mathlibStandardSet false

open scoped BigOperators
open scoped Real
open scoped Nat
open scoped Classical
open scoped Pointwise

set_option maxHeartbeats 0
set_option maxRecDepth 4000
set_option synthInstance.maxHeartbeats 20000
set_option synthInstance.maxSize 128

set_option relaxedAutoImplicit false
set_option autoImplicit false

noncomputable section

/-
The Second Hardy-Littlewood conjecture states that pi(x+y) <= pi(x) + pi(y) for integers x, y >= 2.
-/
def SecondHardyLittlewoodConjectureFor (x y : ℕ) : Prop :=
  Nat.primeCounting (x + y) ≤ Nat.primeCounting x + Nat.primeCounting y

/-
The Second Hardy-Littlewood conjecture holds for y=2.
-/
theorem second_hardy_littlewood_conjecture_y_eq_2 {x : ℕ} (hx : 2 ≤ x) :
    SecondHardyLittlewoodConjectureFor x 2 := by
      unfold SecondHardyLittlewoodConjectureFor;
      rw [ Nat.primeCounting, Nat.primeCounting ];
      rw [ Nat.primeCounting', Nat.count_succ ];
      rw [ Nat.count_succ ];
      split_ifs <;> simp_all +arith +decide [ Nat.primeCounting ];
      cases Nat.Prime.eq_two_or_odd ‹Nat.Prime ( x + 1 ) › <;> cases Nat.Prime.eq_two_or_odd ‹Nat.Prime ( x + 2 ) › <;> simp_all +arith +decide [ Nat.add_mod ]

/-
The Second Hardy-Littlewood conjecture holds for y=3.
-/
theorem second_hardy_littlewood_conjecture_y_eq_3 {x : ℕ} (hx : 2 ≤ x) :
    SecondHardyLittlewoodConjectureFor x 3 := by
      have := @second_hardy_littlewood_conjecture_y_eq_2 ( x + 1 ) ( by linarith );
      unfold SecondHardyLittlewoodConjectureFor at *;
      simp_all +arith +decide [ Nat.primeCounting ];
      rw [ Nat.primeCounting' ] at *;
      simp_all +arith +decide [ Nat.count_succ ];
      split_ifs at * <;> norm_num at *

/-
The Second Hardy-Littlewood conjecture holds for y=4.
-/
theorem second_hardy_littlewood_conjecture_y_eq_4 {x : ℕ} (hx : 2 ≤ x) :
    SecondHardyLittlewoodConjectureFor x 4 := by
      unfold SecondHardyLittlewoodConjectureFor;
      rcases x with ( _ | _ | _ | _ | _ | _ | x ) <;> simp +arith +decide [ Nat.primeCounting ] at *;
      norm_num [ Nat.primeCounting' ];
      induction' x with x ih <;> simp +arith +decide [ Nat.count_succ ] at *;
      split_ifs at * <;> simp_all +arith +decide only;
      · cases Nat.Prime.eq_two_or_odd ‹Nat.Prime ( x + 8 ) › <;> cases Nat.Prime.eq_two_or_odd ‹Nat.Prime ( x + 9 ) › <;> cases Nat.Prime.eq_two_or_odd ‹Nat.Prime ( x + 11 ) › <;> simp_all +arith +decide [ Nat.add_mod ];
      · cases Nat.Prime.eq_two_or_odd ‹Nat.Prime ( x + 8 ) › <;> cases Nat.Prime.eq_two_or_odd ‹Nat.Prime ( x + 10 ) › <;> cases Nat.Prime.eq_two_or_odd ‹Nat.Prime ( x + 11 ) › <;> simp_all +arith +decide [ Nat.add_mod ];
      · cases Nat.Prime.eq_two_or_odd ‹Nat.Prime ( x + 9 ) › <;> cases Nat.Prime.eq_two_or_odd ‹Nat.Prime ( x + 10 ) › <;> cases Nat.Prime.eq_two_or_odd ‹Nat.Prime ( x + 11 ) › <;> simp_all +arith +decide [ Nat.add_mod ]

/-
pi(x+y) <= pi(x) + y
-/
theorem primeCounting_add_le_add (x y : ℕ) : Nat.primeCounting (x + y) ≤ Nat.primeCounting x + y := by
  induction' y with y ih <;> simp_all +decide [ Nat.primeCounting ];
  simp_all +arith +decide [ Nat.primeCounting' ];
  grind