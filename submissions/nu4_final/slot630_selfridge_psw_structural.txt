SELFRIDGE/PSW PRIMALITY CONJECTURE — STRUCTURAL LEMMAS AND BOUNDED CASES

PROBLEM STATEMENT (Lean):
structure IsSelfridge (p : ℕ) where
  is_odd : Odd p
  mod_5 : p ≡ 2 [MOD 5] ∨ p ≡ 3 [MOD 5]
  pow_2 : 2^(p-1) ≡ 1 [MOD p]
  fib : (p+1).fib ≡ 0 [MOD p]

theorem selfridge_conjecture (p : ℕ) (hp : IsSelfridge p) : p.Prime

CONTEXT:
The full conjecture is OPEN (no counterexample found up to 2^64). This sketch targets
STRUCTURAL RESULTS about hypothetical counterexamples and BOUNDED VERIFICATION.

Any composite number satisfying the Selfridge conditions would be both a Fermat
pseudoprime base 2 AND a Lucas pseudoprime with specific parameters. Such numbers
are extremely rare — the structural constraints may be provably impossible.

PROOF STRATEGY:

LEMMA 1: Prime Power Elimination
If p = q^a where q is prime and a ≥ 2, then p cannot satisfy IsSelfridge.

Proof approach:
- From 2^(p-1) ≡ 1 (mod p), we have 2^(q^a - 1) ≡ 1 (mod q^a).
- By Lifting the Exponent Lemma (for q odd), v_q(2^(q^a - 1) - 1) depends on v_q(2^(q-1) - 1).
- For the congruence to hold mod q^a with a ≥ 2, we need strict divisibility constraints.
- The Fibonacci condition Fib(p+1) ≡ 0 (mod q^a) requires q^a | Fib(q^a + 1).
- For primes q, the Fibonacci entry point z(q) (smallest m with q | Fib(m)) is well-studied.
- For q^a | Fib(m), we need a | v_q(Fib(m)), which is tightly constrained by z(q).
- The combination of Fermat pseudoprime and Lucas pseudoprime conditions on a prime
  power is rigid enough to derive a contradiction for small a.
- Handle a=2 explicitly, then use induction or direct analysis for a ≥ 3.

LEMMA 2: Two-Factor Lower Bound
Any composite p satisfying IsSelfridge must have at least 2 distinct prime factors.

Proof: Direct from Lemma 1. If p is composite and not a prime power, it has ≥ 2 factors.

LEMMA 3: Fermat Pseudoprime Structure
If p satisfies IsSelfridge and is composite, then for each prime factor q of p,
ord_q(2) | (p-1).

Proof approach:
- 2^(p-1) ≡ 1 (mod p) implies 2^(p-1) ≡ 1 (mod q) for each prime factor q.
- Therefore ord_q(2) | (p-1) by definition of multiplicative order.

LEMMA 4: Lucas Pseudoprime Structure
If p satisfies IsSelfridge and is composite, then for each prime factor q of p,
z(q) | (p+1), where z(q) is the Fibonacci entry point.

Proof approach:
- Fib(p+1) ≡ 0 (mod p) implies q | Fib(p+1) for each prime factor q.
- The entry point z(q) is the minimal positive integer with q | Fib(z(q)).
- Therefore z(q) | (p+1).

LEMMA 5: Combined GCD Constraint
For any prime factor q of a composite p satisfying IsSelfridge,
gcd(ord_q(2), z(q)) | gcd(p-1, p+1) = 1 or 2.

Proof approach:
- From Lemmas 3 and 4: ord_q(2) | (p-1) and z(q) | (p+1).
- Since gcd(p-1, p+1) ∈ {1, 2} (p is odd), the divisibility constraints are tight.
- For most primes q, ord_q(2) and z(q) share common factors (often related to q-1 or q+1).
- The constraint that their gcd divides 1 or 2 is extremely restrictive.

LEMMA 6: Carmichael Number Connection
Any composite p satisfying IsSelfridge must be a Carmichael number.

Proof approach:
- A Carmichael number is composite n such that a^(n-1) ≡ 1 (mod n) for all gcd(a,n)=1.
- For p composite with 2^(p-1) ≡ 1 (mod p), if p is squarefree with λ(p) | (p-1),
  then p is a Fermat pseudoprime base 2.
- Carmichael numbers are exactly squarefree composites with (q-1) | (n-1) for all q|n.
- From Lemma 1, p is squarefree.
- The Fermat condition 2^(p-1) ≡ 1 (mod p) for ALL bases (generalized) would make it
  Carmichael, but we only have base 2.
- However, the Fibonacci condition provides additional structure.
- For Carmichael n, all prime factors q satisfy (q-1) | (n-1).
- Combined with z(q) | (p+1), this creates opposing divisibility constraints.

LEMMA 7: Mod 5 Constraint Interaction
For p ≡ 2 or 3 (mod 5), the Fibonacci condition has special structure.

Proof approach:
- Fibonacci numbers have period mod 5: Fib(k) mod 5 has period 20.
- If p ≡ 2 (mod 5), then p+1 ≡ 3 (mod 5).
- If p ≡ 3 (mod 5), then p+1 ≡ 4 (mod 5).
- For Fib(p+1) ≡ 0 (mod p), we need careful analysis of how p+1 mod 5 interacts
  with the Fibonacci periodicity and the factorization of p.
- If 5 | p (impossible since p ≡ 2,3 mod 5), but for prime factors q of p,
  the entry point z(q) must align with p+1.
- This adds structural constraints beyond the Carmichael condition.

THEOREM: Bounded Verification
For all p < 10000 satisfying the Selfridge conditions (odd, p ≡ 2,3 mod 5,
2^(p-1) ≡ 1 mod p, Fib(p+1) ≡ 0 mod p), p is prime.

Proof approach:
- Use decidable primality test and decidable congruence checks.
- For each odd p < 10000 with p ≡ 2 or 3 (mod 5), check:
  * Is 2^(p-1) ≡ 1 (mod p)? (Fermat test)
  * Is Fib(p+1) ≡ 0 (mod p)? (Lucas test)
  * If both hold, is p prime?
- This is a finite computation suitable for `decide` or `native_decide`.
- No counterexample exists in this range (verified computationally in literature).

CONCLUSION:
Even if the full conjecture is unprovable, the structural lemmas above demonstrate
that any counterexample must be:
  (1) Squarefree (not a prime power)
  (2) A Carmichael-like number with opposing divisibility constraints
  (3) Have prime factors q with gcd(ord_q(2), z(q)) ≤ 2
  (4) Satisfy tight mod 5 periodicity constraints on Fibonacci

Combined with bounded verification to p < 10000 (or higher if decidable), this
establishes partial progress toward the full conjecture.

Aristotle: Prove what you can. Prioritize Lemma 1 (prime power), Lemma 6 (Carmichael
structure), and the bounded theorem. The structural constraints are valuable even if
the full conjecture remains open.
