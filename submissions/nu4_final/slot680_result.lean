/-
This file was generated by Aristotle (https://aristotle.harmonic.fun).

Lean version: leanprover/lean4:v4.24.0
Mathlib version: f897ebcf72cd16f89ab4577d0c826cd14afaafc7
This project request had uuid: 2b949192-0fdf-4b2d-b6cf-93ebc664e71a

To cite Aristotle, tag @Aristotle-Harmonic on GitHub PRs/issues, and add as co-author to commits:
Co-authored-by: Aristotle (Harmonic) <aristotle-harmonic@harmonic.fun>

Aristotle's budget for this request has been reached.
If there is partial progress, it will appear in this file.
If you would like to continue working off of this partial progress,
please submit the same prompt, and add this .lean file in "Optional: Attach a Lean file as context" field.
-/

import Mathlib

set_option linter.mathlibStandardSet false

open scoped BigOperators
open scoped Real
open scoped Nat
open scoped Classical
open scoped Pointwise

set_option maxHeartbeats 0
set_option maxRecDepth 4000
set_option synthInstance.maxHeartbeats 20000
set_option synthInstance.maxSize 128

set_option relaxedAutoImplicit false
set_option autoImplicit false

noncomputable section

/-
Definition of the Selfridge conditions for a natural number p.
-/
def IsSelfridge (p : ℕ) : Prop :=
  Odd p ∧
  (p ≡ 2 [MOD 5] ∨ p ≡ 3 [MOD 5]) ∧
  2^(p-1) ≡ 1 [MOD p] ∧
  Nat.fib (p+1) ≡ 0 [MOD p]

/-
The statement of the Selfridge conjecture as a proposition.
-/
def SelfridgeConjectureStatement : Prop :=
  ∀ p : ℕ, IsSelfridge p → p.Prime

/-
3 is a Selfridge number.
-/
theorem isSelfridge_three : IsSelfridge 3 := by
  constructor <;> norm_num

/-
7 is a Selfridge number.
-/
theorem isSelfridge_seven : IsSelfridge 7 := by
  exact ⟨ by decide, by decide, by decide, by decide ⟩

/-
Any Selfridge number is greater than 1.
-/
theorem isSelfridge_gt_one (p : ℕ) (h : IsSelfridge p) : 1 < p := by
  rcases p with ( _ | _ | p ) <;> simp_all +arith +decide [ IsSelfridge ]

/-
If p is a Selfridge number, then p is coprime to 10.
-/
theorem isSelfridge_coprime_ten (p : ℕ) (h : IsSelfridge p) : p.Coprime 10 := by
  obtain ⟨ hp₁, hp₂, hp₃, hp₄ ⟩ := h;
  rcases Nat.even_or_odd' p with ⟨ b, rfl | rfl ⟩ <;> ring_nf at * <;> norm_num at *;
  · grind;
  · rw [ Nat.Coprime, Nat.gcd_comm, Nat.gcd_rec ];
    rw [ ← Nat.mod_add_div b 10 ] at *; have := Nat.mod_lt b ( by decide : 0 < 10 ) ; interval_cases b % 10 <;> norm_num [ Nat.ModEq, Nat.add_mod, Nat.mul_mod ] at *;

/-
If p is a Selfridge number, then p is odd.
-/
theorem isSelfridge_odd (p : ℕ) (h : IsSelfridge p) : Odd p := by
  exact h.1

/-
If p is a Selfridge number, then p is not divisible by 5.
-/
theorem isSelfridge_not_dvd_five (p : ℕ) (h : IsSelfridge p) : ¬ 5 ∣ p := by
  obtain ⟨ k, hk ⟩ := h;
  rcases hk.1 with ( h | h ) <;> rw [ Nat.dvd_iff_mod_eq_zero ] at * <;> simp_all +arith +decide [ Nat.ModEq ]

/-
If p is a Selfridge number, then p is not a perfect square.
-/
theorem isSelfridge_not_perfect_square (p : ℕ) (h : IsSelfridge p) : ¬ IsSquare p := by
  -- From the definition of a Selfridge number, we know that $p$ is congruent to $2$ or $3$ modulo $5$.
  obtain ⟨h_odd, h_mod_5, h_fermat, h_fib⟩ := h
  have h_mod_5_cases : p % 5 = 2 ∨ p % 5 = 3 := by
    exact h_mod_5;
  rintro ⟨ k, hk ⟩ ; rw [ hk, Nat.mul_mod ] at h_mod_5_cases ; have := Nat.mod_lt k ( by decide : 5 > 0 ) ; interval_cases k % 5 <;> trivial;

/-
5 is not a Selfridge number.
-/
theorem isSelfridge_not_five : ¬ IsSelfridge 5 := by
  -- By definition of IsSelfridge, we need to check if 5 satisfies all conditions.
  unfold IsSelfridge
  simp +decide

/-
2 is not a Selfridge number.
-/
theorem isSelfridge_not_two : ¬ IsSelfridge 2 := by
  -- By definition, 2 is not odd, so it cannot be a Selfridge number.
  simp [IsSelfridge]